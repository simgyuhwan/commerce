# E-Commerce Platform 요구사항

## 프로젝트 개요

중소 상공인을 위한 온라인 쇼핑몰 플랫폼. 상품 판매, 주문 관리, 결제, 배송 추적까지 원스톱 서비스 제공.

### 목표
- 월 거래액 100억 원 처리 가능한 확장성
- 99.9% 가용성 보장
- 실시간 재고 관리 및 동기화
- 다양한 결제 수단 지원

### 주요 이해관계자
- **판매자(Seller)**: 상품 등록, 주문 관리, 정산 확인, 채팅 관리
- **구매자(Consumer)**: 상품 검색, 주문, 결제, 배송 조회
- **관리자(Admin)**: 플랫폼 운영, 정산, CS 처리, 채팅 관리
- **매니저(Manager)**: 판매자를 도와주는 관리자. 상품 등록, 주문 관리, 채팅 관리
- **외부 시스템**: 결제 게이트웨이, 배송사, 카카오 알림톡

## 핵심 비즈니스 프로세스

### 1. 상품 관리
```
판매자 로그인
→ 상품 등록 (이름, 가격, 재고, 이미지)
→ 카테고리 설정
→ 옵션 추가 (색상, 사이즈)
→ 판매 상태 관리 (판매중/품절/판매중지)
```

**제약사항**:
- 상품명 최대 100자
- 이미지 최대 10개, 각 5MB 이하
- 재고 0 이하 시 자동으로 품절 처리

### 2. 주문 프로세스
```
고객 상품 검색
→ 장바구니 추가
→ 주문서 작성 (배송지, 결제 수단)
→ 결제 진행
→ 주문 확정
→ 배송 처리
→ 구매 확정
```

**비즈니스 규칙**:
- 재고 부족 시 주문 불가
- 결제 완료 후 재고 차감
- 결제 실패 시 재고 복원
- 30분 이내 미결제 시 주문 자동 취소

### 3. 결제
```
주문 생성
→ 결제 수단 선택 (신용카드/계좌이체/간편결제)
→ PG사 결제 요청
→ 결제 승인/거절
→ 결제 완료 알림
```

**지원 결제 수단**:
- 신용카드 (국내/해외)
- 계좌이체
- 카카오페이, 네이버페이
- 포인트 결제 (부분 결제 가능)

**제약사항**:
- 결제 타임아웃: 10분
- 재시도 최대 3회
- 실패 시 DLQ로 이동

### 4. 재고 관리
```
상품 등록 → 초기 재고 설정
주문 확정 → 재고 차감
주문 취소 → 재고 복원
반품 승인 → 재고 증가
```

**동시성 제어**:
- 재고 차감은 낙관적 락(Optimistic Lock) 사용
- 재고 0 이하 방지
- 재고 부족 시 대기 큐 운영 (선착순)

### 5. 배송
```
결제 완료
→ 배송 준비 (판매자)
→ 배송사 연동
→ 송장번호 등록
→ 배송 중
→ 배송 완료
→ 구매 확정
```

**배송사 연동**:
- CJ대한통운, 롯데택배, 한진택배
- 실시간 배송 조회 API
- 배송 이벤트 수신 (배송중, 배송완료)

### 6. 정산
```
구매 확정
→ 정산 대기 (7일)
→ 수수료 차감 (5%)
→ 판매자 정산
→ 세금계산서 발행
```

**정산 주기**:
- 주 1회 (매주 월요일)
- 최소 정산 금액: 10,000원
- 정산 내역 메일 발송

## 예상 트래픽

### 일반 시간대
- MAU: 100만 명
- DAU: 20만 명
- 동시 접속자: 1,000명
- TPS: 100

### 피크 시간대 (이벤트, 특가 세일)
- 동시 접속자: 10,000명
- TPS: 1,000
- 주문: 500건/분

## 외부 시스템 의존성

### 결제 게이트웨이
- KG이니시스
- 나이스페이먼츠
- 토스페이먼츠

### 배송 조회
- 스마트택배 API
- 각 택배사 API

### 알림
- 카카오 알림톡
- SMS 
- 이메일 (SendGrid)

## 비기능 요구사항

### 성능
- API 응답 시간: 평균 200ms 이하
- 상품 검색: 1초 이내
- 주문 처리: 3초 이내 (결제 제외)
- 대용량 이미지 업로드: 5MB → 10초 이내

### 가용성
- 99.9% Uptime (연간 다운타임 8.76시간)
- 배포 시 무중단 배포 (Blue-Green)
- DB 장애 시 Read Replica로 자동 Failover

### 확장성
- 수평 확장 가능 (Pod Auto-Scaling)
- Database Sharding 고려
- CDN 활용 (정적 리소스) - 보류

### 보안
- HTTPS 필수
- JWT 기반 인증
- XSS/CSRF 방어
- SQL Injection 방어
- PII 암호화 (개인정보)
- 결제 정보 비저장 (PG사에 위임)

### 모니터링
- APM (Application Performance Monitoring)
- 에러 추적 (Sentry)
- 로그 수집 (ELK Stack)
- 메트릭 수집 (Prometheus + Grafana)

## 기술 스택 제약

### Backend
- Java 17 + Spring Boot 3.x
- JPA/Hibernate
- MariaDB
- Redis (캐시, 세션)
- RabbitMQ 또는 Kafka (이벤트)

### Infrastructure
- Kubernetes
- Docker
- GitHub Actions (CI/CD) or Jenkins

### 3rd Party
- 결제 PG사 SDK

## 특별 요청

### DDD 적용
- Event Storming으로 도메인 분석
- Bounded Context 명확히 구분
- Aggregate 단위로 트랜잭션 관리
- Domain Event 발행/구독

### CQRS 고려
- 조회와 명령 분리
- 읽기 모델 최적화 (Elasticsearch)
- Materialized View 활용

### 마이크로서비스 가능성
- Monolith First 접근
- 추후 분리 가능하도록 Bounded Context 설계
- API Gateway 패턴

## 추가 고려사항

### 다국어
- 현재는 한국어만
- 향후 영어, 중국어 확장 가능성

### 모바일 앱
- API First 설계
- RESTful API

### 데이터 보관
- 주문 데이터: 5년 보관
- 로그: 90일 보관
- 개인정보: 탈퇴 시 즉시 삭제 (법적 보관 제외)

## 성공 지표 (KPI)

- 전환율: 3% 이상
- 평균 주문 금액: 50,000원
- 재구매율: 30% 이상
- 페이지 로딩 속도: 2초 이내
- 결제 성공률: 95% 이상
